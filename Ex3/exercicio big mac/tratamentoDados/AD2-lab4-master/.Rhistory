library(dplyr)
library(ggplot2)
library(tidyr)
ceap <- read.csv("/home/renato/Documentos/UFCG/9 Semestre/AD 2/dadosCEAP.csv")
despesas_na <- filter(ceap, nomeParlamentar == "NA" & valorLíquido > 0)
despesas_na <- gastos_ex_par %>% group_by(tipoDespesa)
View(ceap)
despesas_na <- filter(ceap, nomeParlamentar == "NA" & valorLíquido > 0)
despesas_na <- despesas_na %>% group_by(tipoDespesa)
despesas_normais <- filter(ceap, nomeParlamentar != "NA" & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot()
View(despesas_na)
View(ceap)
despesas_na <- filter(ceap, sgPartido == "NA" & valorLíquido > 0)
despesas_na <- despesas_na %>% group_by(tipoDespesa)
despesas_normais <- filter(ceap, sgPartido != "NA" & valorLíquido > 0)
mediana_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot()
View(despesas_na)
despesas_na <- filter(ceap, sgPartido == "NA")
despesas_na <- despesas_na %>% group_by(tipoDespesa)
despesas_normais <- filter(ceap, sgPartido != "NA" & valorLíquido > 0)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot()
despesas_na <- filter(ceap, sgPartido == "NA")
despesas_na <- despesas_na %>% group_by(tipoDespesa)
despesas_normais <- filter(ceap, sgPartido != "NA" & valorLíquido > 0)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot()
despesas_na <- filter(ceap, sgPartido == "NA")
despesas_normais <- filter(ceap, sgPartido != "NA" & valorLíquido > 0)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot()
View(ceap)
despesas_na <- filter(ceap, sgPartido == "NA")
despesas_normais <- filter(ceap, sgPartido != "NA" & valorLíquido > 0)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot()
despesas_na <- filter(ceap, sgPartido == "NA")
despesas_normais <- filter(ceap, sgPartido != "NA" )
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot()
despesas_na <- filter(ceap, sgPartido == "NA", rm.na = FALSE)
View(despesas_normais)
despesas_na <- filter(ceap, is.na(sgPartido))
despesas_normais <- filter(ceap, sgPartido != "NA" & valorLíquido > 0)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot()
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot()
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot()
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot()
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot() +
abline(mediana_despesas)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
abline(mediana_despesas) +
geom_boxplot()
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot() +
geom_hline(yintercept = media_despesas)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot() +
geom_hline(yintercept = media_despesas)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot() +
geom_hline(yintercept = media_despesas)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot() +
geom_hline(yintercept = media_despesas, show.legend = "Médiana despesas normais")
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE)
geom_hline(yintercept = media_despesas, show.legend = TRUE)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE) +
geom_hline(yintercept = media_despesas, show.legend = TRUE)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa)) +
theme(axis.title.x=element_blank()) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE) +
geom_hline(yintercept = media_despesas, show.legend = TRUE)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa)) +
theme(axis.title.x=element_blank()) +
theme(axis.line.x = element_blank()) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE) +
geom_hline(yintercept = media_despesas, show.legend = TRUE)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa)) +
theme(axis.title.x=element_blank()) +
theme(axis.ticks.x = element_blank()) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE) +
geom_hline(yintercept = media_despesas, show.legend = TRUE)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa)) +
theme(axis.ticks.x = element_blank()) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE) +
geom_hline(yintercept = media_despesas, show.legend = TRUE)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
mediana_despesas <- median(despesas_normais$valorLíquido)
media_despesas <- mean(despesas_normais$valorLíquido)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa)) +
theme_classic() +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE) +
geom_hline(yintercept = media_despesas, show.legend = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(tidyr)
ceap <- read.csv("/home/renato/Documentos/UFCG/9 Semestre/AD 2/dadosCEAP.csv")
gastos_ex_par <- filter(ceap, tipoDocumento == 2 & valorLíquido > 0)
gastos_ex_par <- gastos_ex_par %>% group_by(nomeParlamentar) %>% summarise(despesas_ext = sum(valorLíquido))
gastos_nac_par <- filter(ceap, tipoDocumento != 2 & valorLíquido > 0)
gastos_nac_par <- gastos_nac_par %>% group_by(nomeParlamentar) %>% summarise(despesas_nac = sum(valorLíquido))
exteriorXnacional <- merge(gastos_ex_par,gastos_nac_par)
exteriorXnacional %>%
ggplot(aes(x = despesas_nac, y = despesas_ext)) +
geom_point() +
theme_classic() +
xlab("Despesas nacionais (R$)") + ylab("Despesas no exterior (R$)")
cor(exteriorXnacional$despesas_ext,exteriorXnacional$despesas_nac)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE) +
geom_hline(yintercept = media_despesas, show.legend = TRUE)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.5)) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE) +
geom_hline(yintercept = media_despesas, show.legend = TRUE)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.1)) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE) +
geom_hline(yintercept = media_despesas, show.legend = TRUE)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
theme(axis.text.x = element_text(angle = 90, hjust = 0)) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE) +
geom_hline(yintercept = media_despesas, show.legend = TRUE)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa)) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE) +
geom_hline(yintercept = media_despesas, show.legend = TRUE)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa)) +
theme(axis.text.x = element_blank()) +
geom_boxplot() +
geom_hline(yintercept = mediana_despesas, show.legend = TRUE) +
geom_hline(yintercept = media_despesas, show.legend = TRUE)
View(despesas_na)
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa)) +
theme(axis.text.x = element_blank()) +
geom_boxplot() +
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa)) +
theme(axis.text.x = element_blank()) +
geom_boxplot()
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa)) +
coord_flip() +
geom_boxplot()
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido)) +
coord_flip() +
geom_boxplot()
despesas_na <- filter(ceap, is.na(sgPartido) & valorLíquido > 0 & valorLíquido < 30000)
despesas_normais <- filter(ceap, !is.na(sgPartido) & valorLíquido > 0)
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa)) +
theme(axis.text.x = element_blank(), legend.position = "bottom") +
geom_boxplot()
despesas <- filter(ceap, valorLíquido > 0)
despesas$eh.lider <- factor(ifelse(is.na(despesas$sgPartido), 1, 0),labels = c("NA", "Normal"))
ggplot(despesas_na, aes(x = tipoDespesa, y = valorLíquido, fill = eh.lider)) +
theme(axis.text.x = element_blank(), legend.position = "bottom") +
geom_boxplot()
library(RColorBrewer)
despesas <- filter(ceap, valorLíquido > 0)
install.packages("RColorBrewer")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(tidyr)
ceap <- read.csv("/home/renato/Documentos/UFCG/9 Semestre/AD 2/dadosCEAP.csv")
library(RColorBrewer)
despesas <- filter(ceap, valorLíquido > 0)
despesas$tipoDespesa.isLider <- factor(ifelse(is.na(despesas$sgPartido), 1, 0),labels = c("NA", "Normal"))
ggplot(despesas, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa.isLider)) +
scale_y_continuous(name = "Valor despesa (R$)",
breaks = seq(0, 175, 25),
limits=c(0, 175)) +
scale_x_discrete(name = "Tipo despesa") +
ggtitle("Despesas deputados anônimos Vs deputados identificados") +
theme_bw() +
theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(size = 12, family = "Tahoma"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 11),
legend.position = "bottom") +
scale_fill_brewer(palette = "Accent") +
labs(fill = "Temperature")
library(RColorBrewer)
despesas <- filter(ceap, valorLíquido > 0)
despesas$tipoDespesa.isLider <- factor(ifelse(is.na(despesas$sgPartido), 1, 0),labels = c("NA", "Normal"))
ggplot(despesas, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa.isLider)) +
scale_y_continuous(name = "Valor despesa (R$)") +
scale_x_discrete(name = "Tipo despesa") +
ggtitle("Despesas deputados anônimos Vs deputados identificados") +
theme_bw() +
theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(size = 12, family = "Tahoma"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 11),
legend.position = "bottom") +
scale_fill_brewer(palette = "Accent") +
labs(fill = "Temperature")
library(RColorBrewer)
despesas <- filter(ceap, valorLíquido > 0)
despesas$tipoDespesa.isLider <- factor(ifelse(is.na(despesas$sgPartido), 1, 0),labels = c("NA", "Normal"))
ggplot(despesas, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa.isLider)) +
scale_y_continuous(name = "Valor despesa (R$)") +
scale_x_discrete(name = "Tipo despesa") +
ggtitle("Despesas deputados anônimos Vs deputados identificados") +
labs(fill = "Temperature")
library(RColorBrewer)
despesas <- filter(ceap, valorLíquido > 0)
despesas$tipoDespesa.isLider <- factor(ifelse(is.na(despesas$sgPartido), 1, 0),labels = c("NA", "Normal"))
ggplot(despesas, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa.isLider)) +
geom_boxplot(alpha=0.7) +
scale_y_continuous(name = "Valor despesa (R$)",
breaks = seq(0, 175, 25),
limits=c(0, 175)) +
scale_x_discrete(name = "Despesa") +
ggtitle("Despesas deputados anônimos Vs deputados identificados") +
theme_bw() +
theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(size = 12, family = "Tahoma"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 11),
legend.position = "bottom") +
scale_fill_brewer(palette = "Accent") +
labs(fill = "Temperature")
library(RColorBrewer)
despesas <- filter(ceap, valorLíquido > 0)
despesas$tipoDespesa.isLider <- factor(ifelse(is.na(despesas$sgPartido), 1, 0),labels = c("NA", "Normal"))
ggplot(despesas, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa.isLider)) +
geom_boxplot() +
scale_y_continuous(name = "Valor despesa (R$)") +
scale_x_discrete(name = "Despesa") +
ggtitle("Despesas deputados anônimos Vs deputados identificados") +
theme_bw() +
theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(size = 12, family = "Tahoma"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 11),
legend.position = "bottom") +
scale_fill_brewer(palette = "Accent") +
labs(fill = "Temperature")
library(RColorBrewer)
despesas <- filter(ceap, valorLíquido > 0)
despesas$tipoDespesa.isLider <- factor(ifelse(is.na(despesas$sgPartido), 1, 0),labels = c("NA", "Normal"))
ggplot(despesas, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa.isLider)) +
geom_boxplot() +
scale_y_continuous(name = "Valor despesa (R$)",
breaks = seq(0, 175, 25),
limits=c(0, 175)) +
scale_x_discrete(name = "Despesa") +
ggtitle("Despesas deputados anônimos Vs deputados identificados") +
theme_bw() +
theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(size = 12, family = "Tahoma"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 11),
legend.position = "bottom") +
scale_fill_brewer(palette = "Accent") +
labs(fill = "Temperature")
library(RColorBrewer)
despesas <- filter(ceap, valorLíquido > 0)
despesas$tipoDespesa.isLider <- factor(ifelse(is.na(despesas$sgPartido), 1, 0),labels = c("NA", "Normal"))
ggplot(despesas, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa.isLider)) +
geom_boxplot() +
scale_y_continuous(name = "Valor despesa (R$)",
breaks = seq(0, 40000, 5000),
limits=c(0, 40000)) +
scale_x_discrete(name = "Despesa") +
ggtitle("Despesas deputados anônimos Vs deputados identificados") +
theme_bw() +
theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"),
text = element_text(size = 12, family = "Tahoma"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 11),
legend.position = "bottom") +
scale_fill_brewer(palette = "Accent") +
labs(fill = "Temperature")
library(RColorBrewer)
despesas <- filter(ceap, valorLíquido > 0)
despesas$tipoDespesa.isLider <- factor(ifelse(is.na(despesas$sgPartido), 1, 0),labels = c("NA", "Normal"))
ggplot(despesas, aes(x = tipoDespesa, y = valorLíquido, fill = tipoDespesa.isLider)) +
geom_boxplot() +
scale_y_continuous(name = "Valor despesa (R$)",
breaks = seq(0, 40000, 5000),
limits=c(0, 40000)) +
scale_x_discrete(name = "Despesa") +
ggtitle("Despesas deputados anônimos Vs deputados identificados") +
theme_bw() +
theme(axis.text.x=element_blank(),
legend.position = "bottom") +
scale_fill_brewer(palette = "Accent") +
labs(fill = "Parlamentar")
View(ceap)
viagens_parlamentar <- ceap %>% filter(tipoDespesa == "" & valorLíquido > 0) %>% group_by(idCadastro, nomeParlamentar, sgPartido) %>% summarise(gasto_viagens = sum(valorLíquido))
viagens_parlamentar <- viagens_parlamentar %>% top_n(viagens_parlamentar$gasto_viagens, n = 10)
ggplot(viagens_parlamentar, aes(x = reorder(nomeParlamentar, gasto_viagens), y = gasto_viagens, fill = sgUF)) +
geom_bar(stat="identity") +
theme(axis.title.y=element_blank()) +
coord_flip() +
ylab("Quantidade de Viagens") +
ggtitle("Os deputados que mais viajam")
viagens_parlamentar <- ceap %>% filter(tipoDespesa == "" & valorLíquido > 0) %>% group_by(idCadastro, nomeParlamentar, sgUF) %>% summarise(gasto_viagens = sum(valorLíquido))
viagens_parlamentar <- viagens_parlamentar %>% top_n(viagens_parlamentar$gasto_viagens, n = 10)
ggplot(viagens_parlamentar, aes(x = reorder(nomeParlamentar, gasto_viagens), y = gasto_viagens, fill = sgUF)) +
geom_bar(stat="identity") +
theme(axis.title.y=element_blank()) +
coord_flip() +
ylab("Quantidade de Viagens") +
ggtitle("Os deputados que mais viajam")
viagens_parlamentar <- ceap %>% filter(tipoDespesa == "" & valorLíquido > 0) %>% group_by(idCadastro, nomeParlamentar, sgUF) %>% summarise(gasto_viagens = sum(valorLíquido))
viagens_parlamentar <- viagens_parlamentar %>% top_n(viagens_parlamentar$gasto_viagens, n = 10)
ggplot(viagens_parlamentar, aes(x = reorder(nomeParlamentar, gasto_viagens), y = gasto_viagens, fill = sgUF)) +
geom_bar(stat="identity")
viagens_parlamentar <- ceap %>% filter(tipoDespesa == "" & valorLíquido > 0) %>% group_by(idCadastro, nomeParlamentar, sgUF) %>% summarise(gasto_viagens = sum(valorLíquido))
viagens_parlamentar <- viagens_parlamentar %>% top_n(viagens_parlamentar$gasto_viagens, n = 10)
ggplot(viagens_parlamentar, aes(x = reorder(nomeParlamentar, gasto_viagens), y = gasto_viagens, fill = sgUF)) +
geom_bar(stat="identity") +
theme(axis.title.y=element_blank()) +
coord_flip() +
ylab("Quantidade de Viagens") +
ggtitle("Os deputados que mais viajam")
viagens_parlamentar <- ceap %>% filter((tipoDespesa == "PASSAGENS AÉREAS" | tipoDespesa == "Emissão Bilhete Aéreo") & valorLíquido > 0) %>% group_by(idCadastro, nomeParlamentar, sgUF) %>% summarise(gasto_viagens = sum(valorLíquido))
viagens_parlamentar <- viagens_parlamentar %>% top_n(viagens_parlamentar$gasto_viagens, n = 10)
viagens_parlamentar <- ceap %>% filter((tipoDespesa == "PASSAGENS AÉREAS" | tipoDespesa == "Emissão Bilhete Aéreo") & valorLíquido > 0) %>% group_by(idCadastro, nomeParlamentar, sgUF) %>% summarise(gasto_viagens = sum(valorLíquido)) %>% ungroup()
viagens_parlamentar <- viagens_parlamentar %>% top_n(viagens_parlamentar$gasto_viagens, n = 10)
ggplot(viagens_parlamentar, aes(x = reorder(nomeParlamentar, gasto_viagens), y = gasto_viagens, fill = sgUF)) +
geom_bar(stat="identity") +
theme(axis.title.y=element_blank()) +
coord_flip() +
ylab("Gasto com viagens") +
ggtitle("Os deputados que mais viajam")
viagens_parlamentar <- ceap %>% filter((tipoDespesa == "PASSAGENS AÉREAS" | tipoDespesa == "Emissão Bilhete Aéreo") & valorLíquido > 0) %>% group_by(idCadastro, nomeParlamentar, sgUF) %>% summarise(gasto_viagens = sum(valorLíquido)) %>% ungroup()
viagens_parlamentar <- viagens_parlamentar %>% top_n(viagens_parlamentar$gasto_viagens, n = 10)
ggplot(viagens_parlamentar, aes(x = reorder(nomeParlamentar, gasto_viagens), y = gasto_viagens, fill = sgUF)) +
geom_bar(stat="identity") +
theme(axis.title.y=element_blank()) +
coord_flip() +
ylab("Gasto com viagens (R$)") +
ggtitle("Os deputados que mais gastam com viagem") +
labs(fill = "Estado")
gastos_ex_par <- filter(ceap, tipoDocumento == 2 & valorLíquido > 0)
gastos_ex_par <- gastos_ex_par %>% group_by(nomeParlamentar) %>% summarise(despesas_ext = sum(valorLíquido))
gastos_nac_par <- filter(ceap, tipoDocumento != 2 & valorLíquido > 0)
gastos_nac_par <- gastos_nac_par %>% group_by(nomeParlamentar) %>% summarise(despesas_nac = sum(valorLíquido))
exteriorXnacional <- merge(gastos_ex_par,gastos_nac_par)
exteriorXnacional %>%
ggplot(aes(x = despesas_nac, y = despesas_ext)) +
geom_point() +
theme_classic() +
xlab("Despesas nacionais (R$)") + ylab("Despesas no exterior (R$)")
cor(exteriorXnacional$despesas_ext,exteriorXnacional$despesas_nac)
install.packages("tidyverse")
install.packages("caret")
reg_mul1 = lm(votos ~ UF + partido
+ setor_economico_receita +  quantidade_doacoes+ quantidade_doadores + total_receita + media_receita
+ recursos_de_outros_candidatos.comites + recursos_de_partidos + recursos_de_pessoas_físicas
+ recursos_de_pessoas_juridicas + recursos_proprios + quantidade_despesas
+ quantidade_fornecedores + total_despesa + media_despesa + setor_economico_despesa
+ idade + sexo + grau + estado_civil, data=eleicoes2014)
library(caret)
eleicoes2014 <- read.csv("eleicoes2014.csv", fileEncoding="latin1")
reg_mul1 = lm(votos ~ UF + partido
+ setor_economico_receita +  quantidade_doacoes+ quantidade_doadores + total_receita + media_receita
+ recursos_de_outros_candidatos.comites + recursos_de_partidos + recursos_de_pessoas_físicas
+ recursos_de_pessoas_juridicas + recursos_proprios + quantidade_despesas
+ quantidade_fornecedores + total_despesa + media_despesa + setor_economico_despesa
+ idade + sexo + grau + estado_civil, data=eleicoes2014)
reg_mul1 = lm(votos ~ UF + partido
+ setor_economico_receita +  quantidade_doacoes+ quantidade_doadores + total_receita + media_receita
+ recursos_de_outros_candidatos.comites + recursos_de_partidos + recursos_de_pessoas_físicas
+ recursos_de_pessoas_juridicas + recursos_proprios + quantidade_despesas
+ quantidade_fornecedores + total_despesa + media_despesa + setor_economico_despesa
+ idade + sexo + grau + estado_civil, data=eleicoes2014)
summary(reg_mul1)
install.packages("tidyverse")
install.packages("caret")
library(caret)
library(tidyverse)
fitControl <- trainControl(method = "cv",
number = 10)
library(caret)
library(dplyr)
library(ggplot2)
library(tidyr)
treino <- read.csv("train.csv", encoding="UTF-8")
teste <- read.csv("test.csv", encoding="UTF-8")
summary(treino)
treino <- treino %>% select(-nome, -setor_economico_receita, -cargo, -setor_economico_despesa)
teste <- teste %>% select(-nome, -setor_economico_receita, -cargo, -setor_economico_despesa)
treino$recursos_de_partidos[is.na(treino$recursos_de_partidos)] <- median(treino$recursos_de_partidos, na.rm = TRUE)
treino$recursos_de_outros_candidatos.comites[is.na(treino$recursos_de_outros_candidatos.comites)] <- median(treino$recursos_de_outros_candidatos.comites, na.rm = TRUE)
treino$recursos_de_pessoas_juridicas[is.na(treino$recursos_de_pessoas_juridicas)] <- median(treino$recursos_de_pessoas_juridicas, na.rm = TRUE)
treino$recursos_proprios[is.na(treino$recursos_proprios)] <- median(treino$recursos_proprios, na.rm = TRUE)
treino$recursos_de_pessoas_físicas[is.na(treino$recursos_de_pessoas_físicas)] <- median(treino$recursos_de_pessoas_físicas, na.rm = TRUE)
teste$recursos_de_partidos[is.na(teste$recursos_de_partidos)] <- median(teste$recursos_de_partidos, na.rm = TRUE)
teste$recursos_de_outros_candidatos.comites[is.na(teste$recursos_de_outros_candidatos.comites)] <- median(teste$recursos_de_outros_candidatos.comites, na.rm = TRUE)
teste$recursos_de_pessoas_juridicas[is.na(teste$recursos_de_pessoas_juridicas)] <- median(teste$recursos_de_pessoas_juridicas, na.rm = TRUE)
teste$recursos_proprios[is.na(teste$recursos_proprios)] <- median(teste$recursos_proprios, na.rm = TRUE)
teste$recursos_de_pessoas_físicas[is.na(teste$recursos_de_pessoas_físicas)] <- median(teste$recursos_de_pessoas_físicas, na.rm = TRUE)
fitControl <- trainControl(method = "cv",
number = 10)
lasso <- train(votos ~ ., data=treino,
method="lasso",
metric="RMSE",
tuneLength = 10,
trControl=fitControl)
